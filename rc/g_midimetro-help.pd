#N canvas 531 38 537 683 10;
#X obj 74 117 tgl 15 0 empty empty run 17 7 0 10 -262144 -1 -1 1 1
;
#X msg 141 193 reopen;
#X msg 52 276 bang;
#X obj 127 84 openpanel;
#X msg 127 165 open \$1;
#X obj 127 61 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X msg 213 113 symbol media/Fugue.mid;
#X msg 200 85 symbol media/billy_idol-rebel_yell.mid;
#X text 31 255 advance 1 tick;
#X msg 227 140 symbol media/test_midi.mid;
#X text 233 165 ^ test \, has no tempo or time sig;
#X obj 265 284 g_hsl bpm 80 200;
#X obj 265 319 g_tgl loop;
#X obj 265 355 g_tgl eof;
#X text 338 359 stop at the end of the file?;
#X msg 265 258 bpm 120 \, loop 0 \, eof 0;
#X obj 265 556 bng 15 250 50 0 empty empty end 17 7 0 10 -262144 -1
-1;
#X obj 310 585 unpack 0 0 0 0;
#X floatatom 310 618 3 0 0 1 / - -, f 3;
#X floatatom 339 618 3 0 0 1 - - -, f 3;
#X obj 265 526 route bang time_sig bpm;
#X floatatom 355 557 5 0 0 1 bpm - -, f 5;
#X obj 310 644 pack f f;
#X text 366 618 time signature;
#X text 280 498 outputs bpm & [midifile] info;
#X floatatom 127 499 5 0 0 1 ticks - -, f 5;
#N canvas 770 363 414 357 show 0;
#X obj 88 82 unpack f f;
#X obj 34 328 outlet;
#X obj 61 299 outlet;
#X obj 61 270 sel 0;
#X obj 34 214 sel 0;
#X obj 61 137 *;
#X obj 88 54 inlet time sig;
#X obj 34 27 inlet ticks;
#X text 96 161 ticks per measure;
#X text 124 216 ticks per beat;
#X text 240 82 8th notes are 2 ticks;
#X text 240 106 16th notes are 1 tick;
#X text 240 127 half notes are 8 ticks;
#X text 240 148 whole notes are 16 ticks;
#X text 122 300 4/4 time is 16 ticks per measure \, 4 per beat;
#X text 121 325 3/8 time is 6 ticks per measure \, 2 per beat;
#X obj 145 114 expr 4*(4/$f1);
#X text 193 53 convert from 4 beats per measure;
#X obj 61 244 mod 3;
#X obj 34 184 mod 6;
#X floatatom 88 216 5 0 0 0 - - -, f 5;
#X floatatom 61 163 5 0 0 0 - - -, f 5;
#X connect 0 0 5 0;
#X connect 0 1 16 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X connect 4 1 18 0;
#X connect 5 0 21 0;
#X connect 6 0 0 0;
#X connect 7 0 19 0;
#X connect 16 0 20 0;
#X connect 16 0 5 1;
#X connect 18 0 3 0;
#X connect 19 0 4 0;
#X connect 20 0 18 1;
#X connect 21 0 19 1;
#X restore 127 525 pd show beat;
#X obj 127 554 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 196 554 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X text 201 221 rewind to start & reset metro;
#X msg 149 222 rewind;
#X floatatom 178 302 5 0 0 1 cur_pos - -, f 5;
#X msg 178 320 set \$1;
#X floatatom 177 257 5 0 0 1 tick_pos - -, f 5;
#X msg 177 276 pos \$1;
#X obj 312 440 soundoutput;
#N canvas 115 155 586 377 simple 0;
#X obj 11 33 notein;
#X floatatom 44 59 5 0 0 0 - - -, f 5;
#X floatatom 27 81 5 0 0 0 - - -, f 5;
#X floatatom 11 103 5 0 0 0 - - -, f 5;
#X obj 105 34 ctlin;
#X floatatom 132 62 5 0 0 0 - - -, f 5;
#X floatatom 118 86 5 0 0 0 - - -, f 5;
#X floatatom 105 110 5 0 0 0 - - -, f 5;
#X obj 196 34 pgmin;
#X floatatom 223 62 5 0 0 0 - - -, f 5;
#X floatatom 196 87 5 0 0 0 - - -, f 5;
#X obj 11 128 pack f f;
#X obj 11 152 list prepend;
#X obj 11 346 outlet~;
#X obj 230 347 outlet~;
#X msg 60 265 sn;
#X msg 95 265 cp;
#X msg 127 266 hh;
#X obj 11 235 sel 35 36 38 40 39 42 46;
#X msg 159 267 oh;
#X obj 11 302 s_drumelectro;
#X obj 196 236 list split 1;
#X obj 230 295 *~ 0.45;
#X obj 289 34 bendin;
#X floatatom 322 62 5 0 0 0 - - -, f 5;
#X floatatom 289 85 5 0 0 0 - - -, f 5;
#X floatatom 419 61 5 0 0 0 - - -, f 5;
#X floatatom 380 84 5 0 0 0 - - -, f 5;
#X obj 380 33 touchin;
#X floatatom 542 60 5 0 0 0 - - -, f 5;
#X floatatom 510 84 5 0 0 0 - - -, f 5;
#X floatatom 479 108 5 0 0 0 - - -, f 5;
#X obj 479 32 polytouchin;
#X obj 230 267 u_makepolymono 14 1 s_rhodey \$0-rhodeys;
#X obj 11 189 route 10 11;
#X text 188 6 recieve midi data as usual;
#X msg 11 265 bd 250;
#X text 179 152 this is a very basic general midi player;
#X text 95 193 chans 10 & 11 for drums;
#X text 281 235 instrument channels;
#N canvas 561 329 381 215 raw 0;
#X text 16 48 status byte + channels;
#X text 17 80 144 - 159: noteon;
#X text 18 96 160 - 175: poly aftertouch;
#X text 18 114 176 - 191: control change;
#X text 18 132 192 - 207: program change;
#X text 18 149 208 - 223: pitch bend;
#X text 19 165 224 - 239: aftertouch;
#X text 19 185 255 127 len data: Midi File Proprietary Event;
#X text 16 64 128 - 143: noteoff;
#X text 12 8 notes on what values are used to parse raw midi bytes
inside c_midiplay;
#X restore 441 345 pd raw midi vals;
#X obj 11 212 stripnote;
#X connect 0 0 3 0;
#X connect 0 1 2 0;
#X connect 0 2 1 0;
#X connect 1 0 12 1;
#X connect 2 0 11 1;
#X connect 3 0 11 0;
#X connect 4 0 7 0;
#X connect 4 1 6 0;
#X connect 4 2 5 0;
#X connect 8 0 10 0;
#X connect 8 1 9 0;
#X connect 11 0 12 0;
#X connect 12 0 34 0;
#X connect 15 0 20 0;
#X connect 16 0 20 0;
#X connect 17 0 20 0;
#X connect 18 0 36 0;
#X connect 18 1 36 0;
#X connect 18 2 15 0;
#X connect 18 3 15 0;
#X connect 18 4 16 0;
#X connect 18 5 17 0;
#X connect 18 6 19 0;
#X connect 19 0 20 0;
#X connect 20 0 14 0;
#X connect 20 0 13 0;
#X connect 21 1 33 0;
#X connect 22 0 14 0;
#X connect 22 0 13 0;
#X connect 23 0 25 0;
#X connect 23 1 24 0;
#X connect 28 0 27 0;
#X connect 28 1 26 0;
#X connect 32 0 31 0;
#X connect 32 1 30 0;
#X connect 32 2 29 0;
#X connect 33 0 22 0;
#X connect 34 0 41 0;
#X connect 34 1 41 0;
#X connect 34 2 21 0;
#X connect 36 0 20 0;
#X connect 41 0 18 0;
#X restore 312 405 pd simple gm player;
#X text 41 12 gui wrapper for c_midiplay;
#X text 216 12 a midifile player with syncronized metro;
#X text 217 34 requires mrpeach [midifile] external;
#X obj 127 395 g_midimetro midimetro;
#X connect 0 0 40 0;
#X connect 1 0 40 0;
#X connect 2 0 40 0;
#X connect 3 0 4 0;
#X connect 4 0 40 0;
#X connect 5 0 3 0;
#X connect 6 0 4 0;
#X connect 7 0 4 0;
#X connect 9 0 4 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 40 1;
#X connect 15 0 11 0;
#X connect 17 0 18 0;
#X connect 17 1 19 0;
#X connect 18 0 22 0;
#X connect 19 0 22 1;
#X connect 20 0 16 0;
#X connect 20 1 17 0;
#X connect 20 2 21 0;
#X connect 22 0 26 1;
#X connect 25 0 26 0;
#X connect 26 0 27 0;
#X connect 26 1 28 0;
#X connect 30 0 40 0;
#X connect 31 0 32 0;
#X connect 32 0 40 0;
#X connect 33 0 34 0;
#X connect 34 0 40 0;
#X connect 36 0 35 0;
#X connect 36 1 35 1;
#X connect 40 0 25 0;
#X connect 40 1 20 0;
